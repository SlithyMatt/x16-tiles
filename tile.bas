10 PRINT CHR$(147)
20 VPOKE $F,$3000,VPEEK($F,$3000) AND $FE
30 VPOKE $F,$2000,VPEEK($F,$2000) OR $01
100 PRINT ("ENTER LAYER: "): INPUT LR
110 PRINT ("ENTER INDEX: "): INPUT IX
150 LR = $2000 + $1000 * (LR AND 1)
200 BS = VPEEK($F,LR+4) * 4
250 BH = VPEEK($F,LR+5)
300 BS = BS + (BH AND $3F) * $400
350 BK = (BH AND $C0) / $40
400 MD = (VPEEK($F,LR) AND $E0) / $20
410 IF MD > 1 THEN VPOKE $F,$2000,$21
450 CL = VPEEK($F,LR+1)
500 TH = (CL AND $20) / 4 + 8
550 TW = (CL AND $10) / 2 + 8
600 DATA 1,1,2,4,8
650 FOR I = 0 TO 4: READ BP(I): NEXT I
660 DATA 7,7,3,1,0
670 FOR I = 0 TO 4: READ JF(I): NEXT I
700 IS = BP(MD) * TH * TW / 8
710 DATA $80,$80,$C0,$F0,$FF
720 FOR I = 0 TO 4: READ MM(I): NEXT I
750 DATA 2,2,4,16,256
760 FOR I = 0 TO 4: READ MS(I): NEXT I
770 DATA 128,64,32,16,8,4,2,1,128,64,32,16,8,4,2,1,64,16,4,1,16,1,1
780 FOR I = 0 TO 4
790 FOR J = 0 TO JF(I): READ DV(I,J): NEXT J
800 NEXT I
860 JS = BP(MD) * TW / 8
875 DIM BM%(IS-1)
880 Y = 0
890 X = 0
900 FOR I = 0 TO (IS-1)
1000 BM%(I) = VPEEK(BK,BS+IX*IS+I)
1200 NEXT I
1300 FOR I = 0 TO (IS-1)
1500 MK = MM(MD)
1600 FOR J = 0 TO JF(MD)
1610 BT = (BM%(I) AND MK) / DV(MD,J)
1620 VPOKE 0,$1020+X*2+Y*$100,$A0
1710 IF BP(MD) > 4 THEN GOTO 1800
1720 IF BP(MD) = 1 THEN BT = 16 + BT
1800 VPOKE 0,$1021+X*2+Y*$100,BT
1900 X = X + 1
2000 MK = MK / MS(MD)
2100 NEXT J
2200 JS = JS - 1
2300 IF JS > 0 THEN GOTO 2600
2400 Y = Y + 1
2410 X = 0
2510 JS = BP(MD) * TW / 8
2600 NEXT I

